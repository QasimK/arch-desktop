# Security settings

There are various security settings that can be done. These are all optional.

<https://wiki.archlinux.org/title/Security>

This XKCD is extremely relevant <https://xkcd.com/1200/>.

## umask

As described in `man pam_umask`, set the global umask for all logins:

`/etc/pam.d/login`

```
session optional pam_umask.so umask=0027
```

## Restrict logins to specific accounts

`/etc/security/access.d/access.conf`

```
# Only allow local logins for root
+:root:LOCAL

# Allow me to login from anywhere
+:me:ALL

# Disallow anyone else from logging in from anywhere
-:ALL:ALL
```

## ptrace

`/etc/sysctl.d/00-ptrace-scope.conf`

```
# Restrict ptrace to root
kernel.yama.ptrace_scope = 2
```

## kexec

`/etc/sysctl.d/00-kexec-restrict.conf`

```
# Restrict replacing current kernel
kernel.kexec_load_disabled = 1
```

## bpf

`/etc/sysctl.d/00-bpf-harden.conf`

```
# Prevent spraying attacks from non-privileged code
net.core.bpf_jit_harden = 1
```

## IPv6

Disable IPv6 because it is not supported by the ISP (and cause cause VPN leaks).


`/etc/sysctl.d/00-ipv6.conf`

```
# Disable IPv6 to prevent VPN leaks
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
```

## Resource limits

The Arch wiki describes many useful limits.

<https://wiki.archlinux.org/title/Limits.conf>


`/etc/security/limits.d/limits.conf`

```
*           soft    core       0           # Prevent corefiles from being generated by default
*           hard    core       unlimited   # Allow corefiles to be temporarily enabled with ulimit -c unlimited

*           hard    nice       -19         # Prevent non-root users from running a process at minimal niceness
root        hard    nice       -20         # Allows root to run a process when system is unresponsive

*           soft    nofile     100000      # Increase the default max number of files because it is useful
*           hard    nofile     1048576     # Increase the max from 2^19 to the max-max of 2^20

*           hard    nproc      1000        # Prevent fork-bombs from taking out the system
root        hard    nproc      10000       # Prevent root from not being able to launch enough processes
```
